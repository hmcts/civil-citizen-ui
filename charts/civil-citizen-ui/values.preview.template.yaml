postgresql:
  enabled: true
  releaseNameOverride: ${SERVICE_NAME}-postgresql
  image:
    registry: hmctspublic.azurecr.io
    repository: imported/bitnami/postgresql
    tag: '11.3.0'
    pullPolicy: Always
  resources:
    requests:
      cpu: 25m
  initdbScripts:
    init.sql: |-
      CREATE DATABASE cmc WITH OWNER = hmcts ENCODING = 'UTF-8' CONNECTION LIMIT = -1;
      CREATE DATABASE "data-store" WITH OWNER = hmcts ENCODING = 'UTF-8' CONNECTION LIMIT = -1;
      CREATE DATABASE "definition-store" WITH OWNER = hmcts ENCODING = 'UTF-8' CONNECTION LIMIT = -1;
      CREATE DATABASE "user-profile" WITH OWNER = hmcts ENCODING = 'UTF-8' CONNECTION LIMIT = -1;
      CREATE DATABASE "camunda" WITH OWNER = hmcts ENCODING = 'UTF-8' CONNECTION LIMIT = -1;
      CREATE DATABASE "role_assignment" WITH OWNER = hmcts ENCODING = 'UTF-8' CONNECTION LIMIT = -1;
  postgresqlUsername: hmcts
  postgresqlPassword: hmcts
  persistence:
    enabled: false
nodejs:
  # Don't modify below here
  image: ${IMAGE_NAME}
  ingressHost: ${SERVICE_FQDN}
  keyVaults:
    civil:
      resourceGroup: civil-service
      secrets:
        - AppInsightsInstrumentationKey
        - redis-access-key
        - ordnance-survey-api-key
        - idam-secret
  environment:
    OAUTH_CLIENT_REDIRECT: https://${SERVICE_FQDN}/oauth2/callback

java:
  image: 'hmctspublic.azurecr.io/civil/general-applications:latest'
  ingressHost: ${SERVICE_FQDN}
  keyVaults:
    civil:
      resourceGroup: civil-service
      secrets:
        - civil-idam-client-secret
        - microservicekey-civil-service
        - system-update-user-username
        - system-update-user-password
        - cross-access-user-username
        - cross-access-user-password
        - prd-admin-user-username
        - prd-admin-user-password
        - AppInsightsInstrumentationKey
        - docmosis-api-key
        - gov-notify-api-key
        - sendgrid-api-key
        - robotics-notification-sender
        - robotics-notification-recipient
        - launch-darkly-sdk-key
        - robotics-notification-multipartyrecipient
  environment:
    IDAM_CLIENT_ID: civil-service
    IDAM_CLIENT_REDIRECT_URI: https://civil-citizen-ui-{{ .Values.global.environment }}.service.core-compute-{{ .Values.global.environment }}.internal/oauth2/callback
    IDAM_API_URL: https://idam-api.{{ .Values.global.environment }}.platform.hmcts.net
    IDAM_WEB_URL: https://idam-web-public.{{ .Values.global.environment }}.platform.hmcts.net
    IDAM_S2S_AUTH_URL: http://rpe-service-auth-provider-{{ .Values.global.environment }}.service.core-compute-{{ .Values.global.environment }}.internal
    CORE_CASE_DATA_API_URL: http://ccd-data-store-api-${SERVICE_FQDN}
    AUTH_IDAM_CLIENT_BASEURL: https://idam-api.{{ .Values.global.environment }}.platform.hmcts.net
    OIDC_ISSUER: https://forgerock-am.service.core-compute-idam-aat2.internal:8443/openam/oauth2/realms/root/realms/hmcts
    CMC_DB_HOST: ${SERVICE_NAME}-postgresql
    CMC_DB_USERNAME: ${POSTGRES_USER}
    CMC_DB_PASSWORD: ${POSTGRES_PASSWORD}
    CMC_DB_CONNECTION_OPTIONS: '?sslmode=allow'
    REFERENCE_DATABASE_MIGRATION: false
    FEIGN_CLIENT_CONFIG_REMOTERUNTIMESERVICE_URL: http://camunda-${SERVICE_FQDN}/engine-rest/
    FEIGN_CLIENT_CONFIG_REMOTEEXTERNALTASKSERVICE_URL: http://camunda-${SERVICE_FQDN}/engine-rest/
    FEIGN_CLIENT_CONFIG_REMOTEREPOSITORYSERVICE_URL: http://camunda-${SERVICE_FQDN}/engine-rest/
    LAUNCH_DARKLY_ENV: ${SERVICE_FQDN}
    TESTING_SUPPORT_ENABLED: true
    POLLING_EVENT_EMITTER_ENABLED: false
    CASE_DOCUMENT_AM_URL: http://ccd-case-document-am-api-aat.service.core-compute-aat.internal
    DOCUMENT_MANAGEMENT_SECURED: true
    RD_PROFESSIONAL_API_URL: http://rd-professional-api-{{ .Values.global.environment }}.service.core-compute-{{ .Values.global.environment }}.internal

civil-service:
  enabled: true
  java:
    applicationPort: 4000
    releaseNameOverride: ${SERVICE_NAME}-civil-service
    image: 'hmctspublic.azurecr.io/civil/service:latest'
    imagePullPolicy: Always
    ingressHost: civil-service-${SERVICE_FQDN}
    keyVaults:
      civil:
        resourceGroup: civil
        secrets:
          - civil-idam-client-secret
          - microservicekey-civil-service
          - system-update-user-username
          - system-update-user-password
          - cross-access-user-username
          - cross-access-user-password
          - prd-admin-user-username
          - prd-admin-user-password
          - AppInsightsInstrumentationKey
          - docmosis-api-key
