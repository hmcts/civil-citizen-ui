import {IsDefined, IsNotEmpty, MaxLength, ValidateIf} from 'class-validator';
import {FREE_TEXT_MAX_LENGTH} from '../../form/validators/validationConstraints';
import {
  QUESTION_1_REQUIRED,
  QUESTION_2_REQUIRED,
  TEXT_TOO_LONG,
} from '../../form/validationErrors/errorMessageConstants';
import {YesNo} from '../../form/models/yesNo';

export class Vulnerability {
  @IsDefined({message: QUESTION_1_REQUIRED})
    isVulnerable?: string;

  @ValidateIf(o => o.isVulnerable === YesNo.YES)
  @IsDefined({message: QUESTION_2_REQUIRED})
  @IsNotEmpty({message: QUESTION_2_REQUIRED})
  @MaxLength(FREE_TEXT_MAX_LENGTH, {message: TEXT_TOO_LONG})
    vulnerabilityDetails?: string;

  constructor(isVulnerable?: string, vulnerabilityDetails?: string) {
    this.isVulnerable = isVulnerable;
    this.vulnerabilityDetails = vulnerabilityDetails;
  }
}
