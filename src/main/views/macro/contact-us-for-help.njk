{% macro contactUsForHelp(t, widget, open, isCarm=False) %}
  {% set ContactUs = t('COMMON.CONTACT_US_FOR_HELP.TITLE') %}
  {% set Email = t('COMMON.EMAIL') %}
  {% if isCarm %}
    {% set Telephone = t('COMMON.CONTACT_US_FOR_HELP.TELEPHONE_CARM') %}
  {% else %}
    {% set Telephone = t('COMMON.CONTACT_US_FOR_HELP.TELEPHONE') %}
  {% endif %}
  {% set contactocmc = 'contactocmc@justice.gov.uk' %}
  {% set responseDelay = t('COMMON.CONTACT_US_FOR_HELP.RESPONSE_DELAY') %}
  {% set webChat = t('COMMON.CONTACT_US_FOR_HELP.WEB_CHAT') %}
  {% set webChatClosed = t('COMMON.CONTACT_US_FOR_HELP.WEB_CHAT_CLOSED') %}
  {% set webChatUnavailable = t('COMMON.CONTACT_US_FOR_HELP.WEB_CHAT_UNAVAILABLE') %}
  {% set callCharges = t('COMMON.CONTACT_US_FOR_HELP.CALL_CHARGES') %}
  {% if isCarm %}
    {% set openingHours = t('COMMON.CONTACT_US_FOR_HELP.OPENING_HOURS_CARM') %}
  {% else %}
    {% set openingHours = t('COMMON.CONTACT_US_FOR_HELP.OPENING_HOURS') %}
  {% endif %}

  {% set emailWidget = _widget('', Email, 'mailto:contactocmc@justice.gov.uk', 'contactocmc@justice.gov.uk', '', '') %}
  {% set callChargesWidget = _widget(openingHours, Telephone, externalURLs.callChargesUrl, '', callCharges, '0300 123 7050', '_blank') %}
  {% set webChatUnavailableWidget = _widget(webChatUnavailable, webChat, '', '', '', '') %}
  {% set webChatClosedWidget = _widget(webChatClosed, webChat, '', '', '', '') %}
  {% set contactUsForHelpComponentId = 'contact-us-for-help' %}

  {% set disclosure = t('COMMON.CONTACT_US_FOR_HELP.COURT_STAFF_DISCLOSURE') %}
  {% set sendMessageTitle = t('COMMON.CONTACT_US_FOR_HELP.SEND_MESSAGE') %}
  {% set sendMessageLink = t('COMMON.CONTACT_US_FOR_HELP.SEND_MESSAGE_LINK') %}
  {% set sendMessageHint = t('COMMON.CONTACT_US_FOR_HELP.SEND_MESSAGE_RESPONSE') %}
  {% if disableSendMessage %}
  {% set qmContent = _widgetRedesign(disclosure, sendMessageTitle, sendMessageLink, sendMessageHint, callChargesWidget) %}
  {% else %}
  {% set qmContent = _widgetRedesign(emailWidget, callChargesWidget) %}
  {% endif %}

  {% set content = '' %}
  {% if widget === 'Web_chat' %}
    {% set content = webChatUnavailableWidget + webChatClosedWidget %}
  {% endif %}
  {% set content = content + emailWidget + callChargesWidget %}
  {% if open %}
    <div class="govuk-details">
       {% if isQMFlagEnabled === true %}
          <p class="govuk-body">
            {{ t('COMMON.QM_INFORMATION_MESSAGES_DOCUMENTS') }}
            <a class="govuk-link" href="{{ qmContactLink }}" rel="noopener noreferrer">
              {{ t('COMMON.QM_INFORMATION_LINK') }}
            </a>.
          </p>
      {% else %}
        {{ emailWidget }}
      {% endif %}
      {{ callChargesWidget }}
    </div>
  {% else %}
    {% if isQMFlagEnabled %}
      {{ govukDetails({
        summaryText: ContactUs,
        html: qmContent,
        id: contactUsForHelpComponentId
      }) }}
      {% else %}
    {{ govukDetails({
      summaryText: ContactUs,
      html: content,
      id: contactUsForHelpComponentId
    }) }}
      {% endif %}
  {% endif %}
{% endmacro %}
