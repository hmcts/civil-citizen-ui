{% extends "claim-details-tpl.njk" %}
{% from "govuk/components/table/macro.njk" import govukTable %}
{% from "govuk/components/textarea/macro.njk" import govukTextarea %}
{% from "govuk/components/button/macro.njk" import govukButton %}
{% from "../../macro/csrf.njk" import csrfProtection %}

{% block content %}

  {% set rows = [[{text: 'Query'}, {text: query.parentQuery.body}]] %}
  {% for response in query.responses %}
    {% set row = [{text: 'Response'}, {text: response.body}] %}
    {% set rows = (rows.push(row), rows) %}
  {% endfor %}

  <div>
    {{ govukTable({
      caption: query.parentQuery.subject,
      captionClasses: "govuk-table__caption--l",
      firstCellIsHeader: true,
      rows: rows
    }) }}
  </div>

  <form method="POST" action="/{{ claimId }}/view-queries/{{ query.parentQuery.id }}">
    {{ csrfProtection(csrf) }}
    {{ govukTextarea({
      label: {
        text: "Write your reply",
        isPageHeading: false
      },
      id: "query-reply-input",
      name: "query-reply-input"
    }) }}

    {{ govukButton({
      text: "Submit"
    }) }}
  </form>
{% endblock %}
